’
fC:\Users\vikyr\source\Repos\MicroservicesTeamC\ProyectoGrupoC\ProyectoGrupoC\Context\AlbaranContext.cs
	namespace 	
GrupoC
 
. 
AlbaranDeEntrega !
.! "
Context" )
{		 
public

 

class

 
AlbaranContext

 
:

  !
	DbContext

" +
{ 
public 
AlbaranContext 
( 
DbContextOptions .
<. /
AlbaranContext/ =
>= >
options? F
)F G
: 	
base
 
( 
options 
) 
{ 	
} 	
public 
DbSet 
< 
Albaran 
> 
	Albaranes '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DbSet 
< 
AlbaranItem  
>  !
AlbaranItems" .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
} 
} ¨
mC:\Users\vikyr\source\Repos\MicroservicesTeamC\ProyectoGrupoC\ProyectoGrupoC\Controllers\AlbaranController.cs
	namespace 	
GrupoC
 
. 
AlbaranDeEntrega !
.! "
Controllers" -
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
AlbaranController "
:# $
ControllerBase% 3
{		 
private

 
readonly

 
IAlbaranProvider

 )
albaranProvider

* 9
;

9 :
public 
AlbaranController  
(  !
IAlbaranProvider! 1
albaranProvider2 A
)A B
{ 	
this 
. 
albaranProvider  
=! "
albaranProvider# 2
;2 3
} 	
[ 	
HttpGet	 
( 
$str !
)! "
]" #
public 
async 
Task 
< 
IActionResult '
>' (
GetAsync) 1
(1 2
int2 5
estanteriaId6 B
)B C
{ 	
var 
result 
= 
await 
albaranProvider .
.. /
GetAsnyc/ 7
(7 8
estanteriaId8 D
)D E
;E F
if 
( 
result 
. 
Count 
!= 
$num  !
)! "
return# )
Ok* ,
(, -
result- 3
)3 4
;4 5
return 
NotFound 
( 
) 
; 
} 	
} 
} ÓS
cC:\Users\vikyr\source\Repos\MicroservicesTeamC\ProyectoGrupoC\ProyectoGrupoC\DAL\AlbaranProvider.cs
	namespace 	
GrupoC
 
. 
AlbaranDeEntrega !
.! "
DAL" %
{ 
public 

class 
AlbaranProvider  
:! "
IAlbaranProvider# 3
{ 
private 
List 
< 
Albaran 
> 
Albaran %
=& '
new( +
(, -
)- .
;. /
public 
AlbaranProvider 
( 
)  
{		 	
Albaran

 
.

 
Add

 
(

 
new

 
Albaran

 #
(

# $
)

$ %
{

& '
Id

( *
=

+ ,
$num

- .
,

. /
AlbaranDate

0 ;
=

< =
DateTime

> F
.

F G
Now

G J
.

J K
	AddMonths

K T
(

T U
-

U V
$num

V W
)

W X
,

X Y
EstanteriaId

Z f
=

g h
$num

i j
,

j k
	Productos 
= 
new 
List  $
<$ %
AlbaranItem% 0
>0 1
(1 2
)2 3
{ 
new 
AlbaranItem #
(# $
)$ %
{& '
	AlbaranId( 1
=2 3
$num4 5
,5 6
Id7 9
=: ;
$num< =
,= >

ProductoId? I
=J K
$strL O
,O P
CantidadQ Y
=Z [
$num\ ]
}] ^
,^ _
new 
AlbaranItem #
(# $
)$ %
{& '
	AlbaranId( 1
=2 3
$num4 5
,5 6
Id7 9
=: ;
$num< =
,= >

ProductoId? I
=J K
$strL O
,O P
CantidadQ Y
=Z [
$num\ ]
}] ^
,^ _
new 
AlbaranItem #
(# $
)$ %
{& '
	AlbaranId( 1
=2 3
$num4 5
,5 6
Id7 9
=: ;
$num< =
,= >

ProductoId? I
=J K
$strL O
,O P
CantidadQ Y
=Z [
$num\ ]
}] ^
} 
} 
) 
; 
Albaran 
. 
Add 
( 
new 
Albaran #
(# $
)$ %
{ 
Id 
= 
$num 
, 
EstanteriaId 
= 
$num  
,  !
AlbaranDate 
= 
DateTime &
.& '
Now' *
.* +
	AddMonths+ 4
(4 5
-5 6
$num6 7
)7 8
,8 9
	Productos 
= 
new 
List  $
<$ %
AlbaranItem% 0
>0 1
(1 2
)2 3
{ 
new 
AlbaranItem #
(# $
)$ %
{& '
	AlbaranId( 1
=2 3
$num4 5
,5 6
Id7 9
=: ;
$num< =
,= >

ProductoId? I
=J K
$strL O
,O P
CantidadQ Y
=Z [
$num\ ]
}] ^
,^ _
new 
AlbaranItem #
(# $
)$ %
{& '
	AlbaranId( 1
=2 3
$num4 5
,5 6
Id7 9
=: ;
$num< =
,= >

ProductoId? I
=J K
$strL O
,O P
CantidadQ Y
=Z [
$num\ ]
}] ^
,^ _
new 
AlbaranItem #
(# $
)$ %
{& '
	AlbaranId( 1
=2 3
$num4 5
,5 6
Id7 9
=: ;
$num< =
,= >

ProductoId? I
=J K
$strL O
,O P
CantidadQ Y
=Z [
$num\ ]
}] ^
} 
} 
) 
; 
Albaran 
. 
Add 
( 
new 
Albaran #
(# $
)$ %
{ 
Id   
=   
$num   
,   
EstanteriaId!! 
=!! 
$num!!  
,!!  !
AlbaranDate"" 
="" 
DateTime"" &
.""& '
Now""' *
.""* +
	AddMonths""+ 4
(""4 5
-""5 6
$num""6 7
)""7 8
,""8 9
	Productos## 
=## 
new## 
List##  $
<##$ %
AlbaranItem##% 0
>##0 1
(##1 2
)##2 3
{$$ 
new%% 
AlbaranItem%% #
(%%# $
)%%$ %
{%%& '
	AlbaranId%%( 1
=%%2 3
$num%%4 5
,%%5 6
Id%%7 9
=%%: ;
$num%%< =
,%%= >

ProductoId%%? I
=%%J K
$str%%L O
,%%O P
Cantidad%%Q Y
=%%Z [
$num%%\ ]
}%%] ^
,%%^ _
new&& 
AlbaranItem&& #
(&&# $
)&&$ %
{&&& '
	AlbaranId&&( 1
=&&2 3
$num&&4 5
,&&5 6
Id&&7 9
=&&: ;
$num&&< =
,&&= >

ProductoId&&? I
=&&J K
$str&&L O
,&&O P
Cantidad&&Q Y
=&&Z [
$num&&\ ]
}&&] ^
,&&^ _
new'' 
AlbaranItem'' #
(''# $
)''$ %
{''& '
	AlbaranId''( 1
=''2 3
$num''4 5
,''5 6
Id''7 9
='': ;
$num''< =
,''= >

ProductoId''? I
=''J K
$str''L O
,''O P
Cantidad''Q Y
=''Z [
$num''\ ]
}''] ^
}(( 
})) 
))) 
;)) 
Albaran** 
.** 
Add** 
(** 
new** 
Albaran** #
(**# $
)**$ %
{++ 
Id,, 
=,, 
$num,, 
,,, 
EstanteriaId-- 
=-- 
$num--  
,--  !
AlbaranDate.. 
=.. 
DateTime.. &
...& '
Now..' *
...* +
	AddMonths..+ 4
(..4 5
-..5 6
$num..6 7
)..7 8
,..8 9
	Productos// 
=// 
new// 
List//  $
<//$ %
AlbaranItem//% 0
>//0 1
(//1 2
)//2 3
{00 
new11 
AlbaranItem11 #
(11# $
)11$ %
{11& '
	AlbaranId11( 1
=112 3
$num114 5
,115 6
Id117 9
=11: ;
$num11< =
,11= >

ProductoId11? I
=11J K
$str11L O
,11O P
Cantidad11Q Y
=11Z [
$num11\ ]
}11] ^
,11^ _
new22 
AlbaranItem22 #
(22# $
)22$ %
{22& '
	AlbaranId22( 1
=222 3
$num224 5
,225 6
Id227 9
=22: ;
$num22< =
,22= >

ProductoId22? I
=22J K
$str22L O
,22O P
Cantidad22Q Y
=22Z [
$num22\ ]
}22] ^
,22^ _
new33 
AlbaranItem33 #
(33# $
)33$ %
{33& '
	AlbaranId33( 1
=332 3
$num334 5
,335 6
Id337 9
=33: ;
$num33< =
,33= >

ProductoId33? I
=33J K
$str33L O
,33O P
Cantidad33Q Y
=33Z [
$num33\ ]
}33] ^
}44 
}55 
)55 
;55 
Albaran66 
.66 
Add66 
(66 
new66 
Albaran66 #
(66# $
)66$ %
{77 
Id88 
=88 
$num88 
,88 
AlbaranDate99 
=99 
DateTime99 &
.99& '
Now99' *
.99* +
	AddMonths99+ 4
(994 5
-995 6
$num996 7
)997 8
,998 9
EstanteriaId:: 
=:: 
$num::  
,::  !
	Productos;; 
=;; 
new;; 
List;;  $
<;;$ %
AlbaranItem;;% 0
>;;0 1
(;;1 2
);;2 3
{<< 
new== 
AlbaranItem== #
(==# $
)==$ %
{==& '
	AlbaranId==( 1
===2 3
$num==4 5
,==5 6
Id==7 9
===: ;
$num==< =
,=== >

ProductoId==? I
===J K
$str==L O
,==O P
Cantidad==Q Y
===Z [
$num==\ ]
}==] ^
,==^ _
new>> 
AlbaranItem>> #
(>># $
)>>$ %
{>>& '
	AlbaranId>>( 1
=>>2 3
$num>>4 5
,>>5 6
Id>>7 9
=>>: ;
$num>>< =
,>>= >

ProductoId>>? I
=>>J K
$str>>L O
,>>O P
Cantidad>>Q Y
=>>Z [
$num>>\ ]
}>>] ^
,>>^ _
new?? 
AlbaranItem?? #
(??# $
)??$ %
{??& '
	AlbaranId??( 1
=??2 3
$num??4 5
,??5 6
Id??7 9
=??: ;
$num??< =
,??= >

ProductoId??? I
=??J K
$str??L O
,??O P
Cantidad??Q Y
=??Z [
$num??\ ]
}??] ^
}@@ 
}AA 
)AA 
;AA 
}BB 	
publicCC 
asyncCC 
TaskCC 
<CC 
ICollectionCC %
<CC% &
AlbaranCC& -
>CC- .
>CC. /
GetAsnycCC0 8
(CC8 9
intCC9 <
idCC= ?
)CC? @
{DD 	
varEE 
customerEE 
=EE 
AlbaranEE "
.EE" #
WhereEE# (
(EE( )
oEE) *
=>EE+ -
oEE. /
.EE/ 0
EstanteriaIdEE0 <
==EE= ?
idEE@ B
)EEB C
.EEC D
ToListEED J
(EEJ K
)EEK L
;EEL M
returnFF 
awaitFF 
TaskFF 
.FF 

FromResultFF (
(FF( )
customerFF) 1
)FF1 2
;FF2 3
}GG 	
}HH 
}II «
dC:\Users\vikyr\source\Repos\MicroservicesTeamC\ProyectoGrupoC\ProyectoGrupoC\DAL\IAlbaranProvider.cs
	namespace 	
GrupoC
 
. 
AlbaranDeEntrega !
.! "
DAL" %
{ 
public 

	interface 
IAlbaranProvider %
{ 
Task 
< 
ICollection 
< 
Albaran  
>  !
>! "
GetAsnyc# +
(+ ,
int, /
estanteriaId0 <
)< =
;= >
} 
}		 ˇ+
wC:\Users\vikyr\source\Repos\MicroservicesTeamC\ProyectoGrupoC\ProyectoGrupoC\Migrations\20221019073706_InitialCreate.cs
	namespace 	
GrupoC
 
. 
AlbaranDeEntrega !
.! "

Migrations" ,
{ 
public		 

partial		 
class		 
InitialCreate		 &
:		' (
	Migration		) 2
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str !
,! "
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
AlbaranDate 
=  !
table" '
.' (
Column( .
<. /
DateTime/ 7
>7 8
(8 9
type9 =
:= >
$str? J
,J K
nullableL T
:T U
falseV [
)[ \
,\ ]
EstanteriaId  
=! "
table# (
.( )
Column) /
</ 0
int0 3
>3 4
(4 5
type5 9
:9 :
$str; @
,@ A
nullableB J
:J K
falseL Q
)Q R
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 3
,3 4
x5 6
=>7 9
x: ;
.; <
Id< >
)> ?
;? @
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str $
,$ %
columns 
: 
table 
=> !
new" %
{ 
Id   
=   
table   
.   
Column   %
<  % &
int  & )
>  ) *
(  * +
type  + /
:  / 0
$str  1 6
,  6 7
nullable  8 @
:  @ A
false  B G
)  G H
.!! 

Annotation!! #
(!!# $
$str!!$ 8
,!!8 9
$str!!: @
)!!@ A
,!!A B
	AlbaranId"" 
="" 
table""  %
.""% &
Column""& ,
<"", -
int""- 0
>""0 1
(""1 2
type""2 6
:""6 7
$str""8 =
,""= >
nullable""? G
:""G H
false""I N
)""N O
,""O P

ProductoId## 
=##  
table##! &
.##& '
Column##' -
<##- .
string##. 4
>##4 5
(##5 6
type##6 :
:##: ;
$str##< K
,##K L
nullable##M U
:##U V
false##W \
)##\ ]
,##] ^
Cantidad$$ 
=$$ 
table$$ $
.$$$ %
Column$$% +
<$$+ ,
int$$, /
>$$/ 0
($$0 1
type$$1 5
:$$5 6
$str$$7 <
,$$< =
nullable$$> F
:$$F G
false$$H M
)$$M N
}%% 
,%% 
constraints&& 
:&& 
table&& "
=>&&# %
{'' 
table(( 
.(( 

PrimaryKey(( $
((($ %
$str((% 6
,((6 7
x((8 9
=>((: <
x((= >
.((> ?
Id((? A
)((A B
;((B C
table)) 
.)) 

ForeignKey)) $
())$ %
name** 
:** 
$str** C
,**C D
column++ 
:++ 
x++  !
=>++" $
x++% &
.++& '
	AlbaranId++' 0
,++0 1
principalTable,, &
:,,& '
$str,,( 3
,,,3 4
principalColumn-- '
:--' (
$str--) -
,--- .
onDelete..  
:..  !
ReferentialAction.." 3
...3 4
Cascade..4 ;
)..; <
;..< =
}// 
)// 
;// 
migrationBuilder11 
.11 
CreateIndex11 (
(11( )
name22 
:22 
$str22 1
,221 2
table33 
:33 
$str33 %
,33% &
column44 
:44 
$str44 #
)44# $
;44$ %
}55 	
	protected88 
override88 
void88 
Down88  $
(88$ %
MigrationBuilder88% 5
migrationBuilder886 F
)88F G
{99 	
migrationBuilder:: 
.:: 
	DropTable:: &
(::& '
name;; 
:;; 
$str;; $
);;$ %
;;;% &
migrationBuilder== 
.== 
	DropTable== &
(==& '
name>> 
:>> 
$str>> !
)>>! "
;>>" #
}?? 	
}@@ 
}AA 
^C:\Users\vikyr\source\Repos\MicroservicesTeamC\ProyectoGrupoC\ProyectoGrupoC\Models\Albaran.cs
	namespace 	
GrupoC
 
. 
AlbaranDeEntrega !
.! "
Models" (
{ 
public 

class 
Albaran 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
DateTime 
AlbaranDate #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public 
int 
EstanteriaId 
{  !
get" %
;% &
set' *
;* +
}, -
public 
List 
< 
AlbaranItem 
>  
	Productos! *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
}		 
}

 π
bC:\Users\vikyr\source\Repos\MicroservicesTeamC\ProyectoGrupoC\ProyectoGrupoC\Models\AlbaranItem.cs
	namespace 	
GrupoC
 
. 
AlbaranDeEntrega !
.! "
Models" (
{ 
public 

class 
AlbaranItem 
{ 
public 
int 
	AlbaranId 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 

ProductoId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
}		 
}

 Ç
WC:\Users\vikyr\source\Repos\MicroservicesTeamC\ProyectoGrupoC\ProyectoGrupoC\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
ConfigurationManager 
Configuration "
=# $
builder% ,
., -
Configuration- :
;: ;
SecretClientOptions 
options 
= 
new !
SecretClientOptions" 5
(5 6
)6 7
{ 
Retry 	
=
 
{ 
Delay 
= 
TimeSpan 
. 
FromSeconds #
(# $
$num$ %
)% &
,& '
MaxDelay 
= 
TimeSpan 
. 
FromSeconds '
(' (
$num( *
)* +
,+ ,

MaxRetries 
= 
$num 
, 
Mode 
= 
	RetryMode 
. 
Exponential $
} 
} 
; 
var 
client 

= 
new 
SecretClient 
( 
new !
Uri" %
(% &
$str& M
)M N
,N O
newP S"
DefaultAzureCredentialT j
(j k
)k l
,l m
optionsn u
)u v
;v w
KeyVaultSecret 
secret 
= 
client 
. 
	GetSecret (
(( )
$str) D
)D E
;E F
string 
secretValue 
= 
secret 
. 
Value !
;! "
builder   
.   
Services   
.   
AddControllers   
(    
)    !
;  ! "
builder"" 
."" 
Services"" 
."" #
AddEndpointsApiExplorer"" (
(""( )
)"") *
;""* +
builder## 
.## 
Services## 
.## 
AddSwaggerGen## 
(## 
)##  
;##  !
builder$$ 
.$$ 
Services$$ 
.$$ 
	AddScoped$$ 
<$$ 
IAlbaranProvider$$ +
,$$+ ,
AlbaranProvider$$- <
>$$< =
($$= >
)$$> ?
;$$? @
builder%% 
.%% 
Services%% 
.%% 
AddDbContext%% 
<%% 
AlbaranContext%% ,
>%%, -
(%%- .
options%%. 5
=>%%6 8
options&& 
.&& 
UseSqlServer&& (
(&&( )
secretValue&&) 4
)&&4 5
)'' 
;'' 
var)) 
app)) 
=)) 	
builder))
 
.)) 
Build)) 
()) 
))) 
;)) 
if,, 
(,, 
app,, 
.,, 
Environment,, 
.,, 
IsDevelopment,, !
(,,! "
),," #
),,# $
{-- 
app.. 
... 

UseSwagger.. 
(.. 
).. 
;.. 
app// 
.// 
UseSwaggerUI// 
(// 
)// 
;// 
}00 
app33 
.33 
UseAuthorization33 
(33 
)33 
;33 
app55 
.55 
MapControllers55 
(55 
)55 
;55 
app77 
.77 
Run77 
(77 
)77 	
;77	 
